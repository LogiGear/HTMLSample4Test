/*
	UIZE JAVASCRIPT FRAMEWORK

	http://www.uize.com/reference/Uize.Template.html
	Available under MIT License or GNU General Public License -- http://www.uize.com/license.html
*/
Uize.module({name:'Uize.Template',required:['Uize.String','Uize.String.Replace'],builder:function(){'use strict';var _a=function(){},_b=true,_c=false,_d='string',_e=Uize.String,_f=_e.splitInTwo,_g=_e.trim,_h=_e.Replace.replacerByLookup({'\\':'\\\\','\n':'\\n','\r':'\\r','\'':'\\\''});var _i={},_j=/^\s*=/,_k=/^\s*@/,_l=/^\s*\./,_m=/^!\s*/,_n=/(\r|\n|\r\n)[ \t]*$/,_o=/^[ \t]*(\r|\n|\r\n)[ \t]*/,_p='->',_q={};function _r(_s,_t,_u,_v){if(_t){_t=_t.split(_p);for(var _w= -1,_x=_t.length,_y,_z,_A,_B;++_w<_x;){if(_z=_g((_y=_f(_t[_u?_x-_w-1:_w],'{'))[0])){if(_A=_m.test(_z))_z=_z.replace(_m,'');if(_B=_a.encodings[_z]){if(_u)_A= !_A;var _C=_g(_y[1]),_D=_A?'from':'to',_E=_B[_D];_v&&_v(_z+':'+_D,_E.required);_s=_E.expansion(_s,_C?('{'+_C):'');}}}}return _s;}_a.compile=function(_F,_G){_G=_G||_i;var _H=[],_I={},_J={},_K={},_L=_G.openerToken||'<%',_M=_G.closerToken||'%>',_N=_G.gobbleWhitespace!==_c,_O=_F.length,_P='var output = [];',_Q='return output.join (\'\');',_R=[_P],_S=[],_T=0,_U,_V=_b,_W,_X,_Y,_Z,_0;function _1(_X){
if(_S.length){_R.push('output.push ('+_S.join(',')+');');_S=[];}_R.push(_X);}function required(_2){var _3=arguments;Uize.forEach(_3.length!=1?_3:typeof _2==_d?_2.split(','):_2,function(_4){if(!_I[_4]){_H.push(_4);_I[_4]=1;}});}function input(_5){Uize.copyInto(_K,_5);}function startBlock(_6,_7){_1('function '+_6+' ('+(_7||'')+') {'+_P);}function endBlock(){_1(_Q+'}');}while(_V){_U=_F.indexOf(_L,_T);if(_U<0)_U=_O;_W=_F.slice(_T,_U);if(_V=_U<_O){_T=_F.indexOf(_M,_U+=2);_Z=_j.test(_X=_F.slice(_U,_T));_0=_Z||_l.test(_X);_Y= !_0&&_k.test(_X);_T+=2;}if(_W){if(_N&&_V&& !_0&&_n.test(_W)&&_o.test(_F.substr(_T)))_W=_W.replace(_n,'');_W&&_S.push('\''+_h(_W)+'\'');}if(_V){if(_0){var _8=_f(_Z?_X.replace(_j,''):'input'+_X,_p);_S.push(_r(_g(_8[0]),_8[1],_c,function(_9,_ba){if(!_J[_9]){required(_ba);_J[_9]=1;}}));}else if(_Y){eval(_X.replace(_k,''));}else{_1(_X);}}}_1(_Q);var _bb=_R.join('\n'),_bc=Function('input',_bb);return(_G.result=='full'?{input:_K,required:_H,code:_bb,templateFunction:_bc}:_bc);};
_a.encode=function(_bd,_t,_u){var _be=(_u?'! ':'')+_t;return((_q[_be]||(_q[_be]=Function('e','return '+_r('e',_t,_u))))(_bd));};_a.decode=function(_bf,_B){return _a.encode(_bf,_B,_b)};var _bg=_a.defineStandardEncoding=function(_z,_bh,_bi,_bj){var _bk=_bh+'.'+_bj+' (',_bl=_bh+'.'+_bi+' (';_a.encodings[_z]={to:{required:_bh,expansion:function(_bm,_bn){return _bl+_bm+(_bn&&',')+_bn+')'}},from:{required:_bh,expansion:function(_bm,_bn){return _bk+_bm+(_bn&&',')+_bn+')'}}};};_a.encodings={};_bg('iso8601','Uize.Date','toIso8601','fromIso8601');_bg('json','Uize.Json','to','from');_bg('miniJson','Uize.Json','to','from');_a.encodings.miniJson.to.expansion=function(_bm){return'Uize.Json.to ('+_bm+',\'mini\')'};_bg('tagAttributes','Uize.Xml','toAttributes','fromAttributes');_bg('tagAttributeValue','Uize.Xml','toAttributeValue','fromAttributeValue');_bg('url','Uize.Url','resolve','from');_bg('urlParams','Uize.Url','toParams','fromParams');_bg('urlPiece','Uize.Url','toPiece','fromPiece');return _a;}});