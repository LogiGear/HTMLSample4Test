/*
	UIZE JAVASCRIPT FRAMEWORK

	http://www.uize.com/reference/Uize.Url.html
	Available under MIT License or GNU General Public License -- http://www.uize.com/license.html
*/
Uize.module({name:'Uize.Url',builder:function(){'use strict';var _a=function(){},_b,_c=Uize.isArray;var _d=[],_e={},_f=0,_g={favorQuery:false},_h=/^(\.\.\/)*/;function _i(_j){return _j!=_b?decodeURIComponent(_j):'';}function _k(_l){return encodeURIComponent(_l+'');}function _m(_n,_o){var _p=(_n+='').indexOf('?');if(_p<0&& !_o)_p=_n.length;return{_q:_n.slice(0,_p),_r:_n.slice(_p+1)};}var _s=_a.from=function(_t){var _u=_t&&_t.match(/^(([^:\\\/]+:)\/\/(([^:\\\/]*)(:(\d+))?)?)?(([^\?#]*[\\\/])?(([^\\\/\?#]*?)(\.([^\.\?#]+))?))(\?([^#]*))?(#(.*))?$/);function _v(_w){return _u?(_u[_w]||''):'';}return{href:_t,fullDomain:_v(1),protocol:_v(2),host:_v(3),hostname:_v(4),port:_v(6),pathname:_v(7),folderPath:_v(8),file:_v(9),fileName:_v(10),extension:_v(11),fileType:_v(12),search:_v(13),query:_v(14),hash:_v(15),anchor:_v(16)};};_a.fromParams=function(_x,_y){var _z={};if(_x=_m(_x,(_y||_e).favorQuery!==false)._r){for(var _A= -1,_B=_x.split('&'),_C=_B.length,_D,_E;++_A<_C;){if(_E=(_D=_B[_A].split('='))[0])
_z[_i(_E)]=_i(_D[1]);}}return _z;};_a.fromPiece=_i;_a.getCacheDefeatStr=function(){return Uize.now()+''+Math.round(Math.random()*1000)+_f++;};_a.toRelative=function(_F,_G){if(!_F){return _G;}else{var _H=_G.charAt(0)=='/';if(_H==(_F.charAt(0)=='/')&&_G.match(_h)[0].length==_F.match(_h)[0].length&&_s(_G).fullDomain==_s(_F).fullDomain){var _I='',_J=_F.slice(0,_F.lastIndexOf('/')+1),_K=false,_L;while(!_K){if(!(_K=_G.slice(0,_J.length)==_J)){_K=(_L=_J.lastIndexOf('/',_J.length-2))<0;_I+='../';_J=_J.slice(0,_L+1);}}return _I+_G.slice(_J.length);}else{return _s(_G).fullDomain?_G:null;}}};_a.toAbsolute=function(_F,_M){var _N=_M?_a.from(_M):_e;_N.fullDomain?(_M=''):(_N=_a.from(_F));var _O,_P=_N.folderPath+_M;while(_P!=_O){_O=_P;_P=_P.replace(/([\/\\])[^\/\\]*[\/\\]\.\.(?:[\/\\]|$)/,'$1');}return _N.fullDomain+_P.replace(/\.\.([\/\\]|$)/g,'');};_a.toParams=function(_z){var _B=[],_Q;if(_c(_z))_z=_z.length<2?_z[0]:Uize.copyInto.apply(Uize,[{}].concat(_z));for(var _R in _z)_R&&(_Q=_z[_R])!=_b&&_B.push(_k(_R)+'='+_k(_Q));
return _B.join('&');};_a.toPiece=_k;_a.resolve=function(_n,_z){if(_c(_n)){_z=_n.slice(1).concat(_z||_d);_n=_n[0];}var _x=_a.toParams([_a.fromParams(_n,_g)].concat(_c(_z)?_z:[_z]));return _m(_n)._q+(_x?'?':'')+_x;};return _a;}});