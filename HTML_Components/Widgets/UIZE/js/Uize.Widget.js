/*
	UIZE JAVASCRIPT FRAMEWORK

	http://www.uize.com/reference/Uize.Widget.html
	Available under MIT License or GNU General Public License -- http://www.uize.com/license.html
*/
Uize.module({name:'Uize.Widget',superclass:'Uize.Class',required:'Uize.Node',builder:function(b_a){'use strict';var b_b=null,b_c=true,b_d=false,b_e='string',b_f=Uize,b_g=b_f.isFunction,b_h='concatenated',b_i,b_j=b_f.Node,b_k=b_j.doForAll,b_l=b_j.isNode,b_m=b_j.getById;var b_n=b_a.subclass(function(b_o){var b_p=this;if(b_o){var b_q=b_p.b_r(b_o.idPrefix,b_o.parent);b_q&&b_f.copyInto(b_o,b_q);delete b_o.widgetClass;}b_p.b_s={};b_p.children=b_p.b_t={};}),b_u=b_n.prototype;b_n.instanceMethods({b_r:function(b_v,b_w){var b_o,b_x;(b_v&&(b_o=window[b_x='$'+b_v])&&typeof b_o=='object'&&(!b_w||b_v!=b_w.b_v))?(window[b_x]=b_i):(b_o=b_i);return b_o;},b_y:function(){var b_p=this,b_q=b_p.b_r(b_p.b_v,b_p.parent);b_q&&b_p.set(b_q);},b_z:function(b_A,b_B,b_C,b_D){return((!b_D||b_D==b_h)&&b_A!=b_i?(b_A+(b_C!==''?'_':'')+b_C):(b_D=='same as parent'?b_A:b_B));},b_E:function(){return this.b_F||this.getNode('shell')||this.getNode();},b_G:function(b_H,b_I,b_J){var b_K='show'+b_f.capFirstChar(b_H);this.getProvider(b_K)
?this.callInherited(b_K)(b_I):setTimeout(function(){var b_L=b_J();(b_I.callback||(b_L?b_I.yesHandler:b_I.noHandler)||b_f.nop)(b_L)},0);}});b_n.instanceMethods({showInform:b_i,showConfirm:b_i,confirm:function(b_I){this.b_G('confirm',b_I,function(){return confirm(b_I.message)});},inform:function(b_I){this.b_G('inform',b_I,function(){alert(b_I.message);return b_c})},ajax:function(b_M,b_N){this.callInherited('performAjax')(b_M,b_f.isFunction(b_N)?{callback:b_N}:b_N||{})},localize:function(b_O,b_P,b_Q){var b_R,b_S=this;while(!(b_R=b_S.b_T?b_S.b_T[b_O]:b_i)&&(b_S=b_S.parent));return(b_g(b_R)?b_R.call(this,b_P):b_f.substituteInto(b_R,b_P,b_Q||'{KEY}'));},getHtml:function(b_U){var b_p=this,b_V=b_p.b_V;if(b_V!=b_i){if(b_V===b_c){var b_W=b_p.b_E();b_V=b_p.b_V=b_f.Template&&b_W?{process:b_f.Template.compile((b_j.find({root:b_W,tagName:'SCRIPT',type:'text/jst'})[0]||b_W).innerHTML,{openerToken:'[%',closerToken:'%]'})}:b_i;if(!b_V)return;}b_p.b_v||b_p.set({b_v:b_p.instanceId});var b_X=b_f.copyInto({
pathToResources:b_f.pathToResources,blankGif:b_n.getBlankImageUrl()},b_U||b_p.get()),b_Y;b_V=typeof b_V!=b_e&&b_g(b_V.process)?b_V.process.call(b_p,b_X):b_g(b_V)?typeof(b_Y=b_V(b_X))==='string'?b_f.substituteInto(b_Y,b_X):b_Y:b_f.substituteInto(b_V,b_X);}return b_V;},buildHtml:function(b_U){var b_p=this,b_V=b_p.getHtml(b_U);if(b_V!=b_i){var b_W=b_p.b_E();b_j.injectHtml(b_W||document.body,b_V,b_p.b_Z||(b_W?'inner replace':'inner bottom'));b_p.b_0=b_b;b_p.set({b_1:b_c});}},getNode:function(b_2){if(b_2==b_b){if(b_2===b_b)return b_b;b_2='';}var b_p=this;if(b_p.b_3&&typeof b_2==b_e){var b_4=b_p.b_3[b_2];if(b_4!==b_i)b_2=b_4;}if(typeof b_2==b_e){return b_m(b_2,b_p.b_v,b_p.b_0||(b_p.b_0={}));}else if(b_l(b_2)){return b_2;}else{var b_5=b_b;b_k(b_2,function(b_6){(b_5||(b_5=[])).push(b_6)},b_p.b_v,b_p.b_0||(b_p.b_0={}));return b_5;}},flushNodeCache:function(b_7){if(this.b_0)b_7==b_i?(this.b_0=b_b):delete this.b_0[b_7];},globalizeNode:function(b_8){var b_p=this,b_9=document.body;b_k(b_p.getNode(b_8),function(b_6){
if(b_6.parentNode!=b_9){(b_p.b_ba||(b_p.b_ba=[])).push(b_6);b_j.setStyle(b_6,{position:'absolute',left:-10000,top:-10000});b_9.appendChild(b_6);}});},removeNode:function(b_8){b_j.remove(this.getNode(b_8));this.flushNodeCache(b_8);},wireNode:function(b_8,b_bb,b_bc){arguments.length==3?b_j.wire(this.getNode(b_8),b_bb,b_bc,this.instanceId):b_j.wire(this.getNode(b_8),b_bb,this.instanceId);},unwireNode:function(b_8,b_bb,b_bc){if(b_8!==b_i)b_8=this.getNode(b_8);arguments.length==2&&typeof b_bb=='object'&&b_bb&& !b_bb.virtualDomEvent?b_j.unwire(b_8,b_bb,this.instanceId):b_j.unwire(b_8,b_bb,b_bc,this.instanceId);},unwireNodeEventsByMatch:function(b_8,b_bd){this.unwireNode(b_8,(b_bd||(b_bd={})).eventName,b_bd.handler);}});function b_be(b_bf,b_bg){b_u[b_bf+'Node'+b_bg]=Function('arguments.length'+'?(arguments[0]=this.getNode(arguments[0]))'+':(arguments[arguments.length++]=this.getNode());'+'return Uize.Node.'+b_bf+b_bg+'.apply(0,arguments)');}b_be('get','Style');b_be('get','Value');b_be('display','');
b_be('inject','Html');b_be('set','Properties');b_be('set','Opacity');b_be('set','Style');b_be('set','ClipRect');b_be('set','InnerHtml');b_be('set','Value');b_be('show','');b_n.instanceMethods({addChild:function(b_C,b_bh,b_o){if(!b_o)b_o={};var b_p=this,b_v=b_p.b_v,b_bi=b_f.isInstance(b_bh)?b_bh:b_b,b_B='idPrefix'in b_o?b_o.idPrefix:b_o.node,b_bj=b_o.idPrefixConstruction;b_o.parent=b_p;if(b_C==b_i)b_C=b_o.name;if(b_bi){if(b_C==b_i)b_C=b_bi.b_bk;if(b_B==b_i)b_B=b_bi.b_v;if(!b_bj)b_bj=b_bi.b_D;}b_o.idPrefix=b_p.b_z(b_v,b_B,b_o.name=b_C,b_o.idPrefixConstruction=b_bj||(b_B==b_i?b_h:'explicit'));var b_s=b_p.b_s,b_bl=b_s[b_C];if(b_bl){b_f.copyInto(b_o,b_bl);delete b_s[b_C];}b_bi&&b_bi.set(b_o);return b_p.b_t[b_C]=b_bi||new b_bh(b_o);},removeChild:function(b_bm){var b_t=this.b_t,b_C=typeof b_bm==b_e||b_f.isNumber(b_bm)?b_bm:b_bm.b_bk,b_bi=b_t[b_C];if(b_bi){b_bi.unwireUi();delete b_bi.parent;delete b_t[b_C];}},getProvider:function(b_bn){var b_bo=this,b_bp;while(((b_bp=b_bo.get(b_bn))==='inherit'||b_bp===b_i)&&
(b_bo=b_bo.parent));return b_bo;},getInherited:function(b_bn){var b_bq=this.getProvider(b_bn);return b_bq?b_bq.get(b_bn):b_i;},setInherited:function(b_o){var b_bq;for(var b_br in b_o){if(b_bq=this.getProvider(b_br))b_bq.set(b_br,b_o[b_br]);}},callInherited:function(b_bn){var b_p=this;return(function(){var b_bq=b_p.getProvider(b_bn),b_5;if(b_bq){var b_bs=b_bq.get(b_bn);if(b_g(b_bs))b_5=b_bs.apply(b_bq,arguments);}return b_5;});}});b_n.instanceMethods({kill:function(){b_f.callOn(this.b_t,'kill');b_a.doMy(this,'kill');},insertOrWireUi:function(){this.b_1?this.wireUi():this.insertUi();},insertUi:function(){this.buildHtml();this.wireUi();},removeUi:function(){this.unwireUi();this.removeNode();b_j.remove(this.b_ba);this.b_ba=b_i;b_f.callOn(this.b_t,'removeUi');this.set({b_1:b_d});},updateUi:function(){},wireUi:function(){if(!this.isWired){this.b_y();this.set({wired:b_c});b_f.callOn(this.b_t,'insertOrWireUi');this.updateUi();}},unwireUi:function(){if(this.isWired){this.b_0=b_b;this.unwireNode();
b_f.callOn(this.b_t,'unwireUi');this.set({wired:b_d});}}});b_n.getBlankImageUrl=function(){return b_f.pathToResources+'Uize/blank.gif';};b_n.spawn=function(b_o,b_w){var b_p=this,b_bt=[],b_bo,b_bu=b_w&&b_w.b_v?b_w.b_v+'_':'',b_bv=b_bu.length;b_k(b_f.Node.find(b_o.idPrefix),function(b_6){b_o.idPrefix=b_6;b_w?(b_bo=b_w.addChild(b_6.id.slice(0,b_bv)==b_bu?b_6.id.slice(b_bv):'generatedChildName'+b_f.getGuid(),b_p,b_o)):(b_bo=new b_p(b_o)).insertOrWireUi();b_bt.push(b_bo);});return b_bt;};b_n.stateProperties({b_1:{name:'built',value:b_c},b_t:{name:'children',conformer:function(b_bp){if(b_bp){var b_t=this.b_t,b_s=this.b_s;for(var b_C in b_bp){var b_bw=b_bp[b_C];b_t[b_C]?b_t[b_C].set(b_bw):b_s[b_C]=b_bw;}}return this.b_t;}},b_F:'container',b_V:'html',b_v:{name:'idPrefix|node',conformer:function(b_v){return(b_l(b_v)?(b_v.id||(b_v.id=b_f.getGuid())):b_v);},onChange:function(){var b_p=this,b_v=b_p.b_v;b_p.b_0=b_b;if(b_v!=b_i){b_p.b_y();var b_t=b_p.b_t,b_bi;for(var b_C in b_t)(b_bi=b_t[b_C]).set({b_v:b_p.b_z(
b_v,b_bi.b_v,b_C,b_bi.b_D)});if(b_p.isWired){b_p.set({wired:b_d});b_p.wireUi();}}}},b_D:'idPrefixConstruction',b_Z:'insertionMode',b_T:'localized',b_bk:'name',b_3:'nodeMap',isWired:{name:'wired',value:b_d}});function b_bx(b_by,b_bz){var b_bA=b_f.keys(b_by),b_bB=b_f.values(b_by),b_bC=b_bA[0],b_bD=b_bA[1];function b_bE(){var b_bp=this[b_bC];if(b_bp=='inherit')b_bp=this.parent?this.parent[b_bD]:b_bz;if(b_bp!=this[b_bD])this.set(b_bD,b_bp);}b_n.stateProperties(b_f.pairUp(b_bC,{name:b_bB[0],onChange:b_bE,value:'inherit'},b_bD,{name:b_bB[1],onChange:function(){b_f.callOn(this.b_t,b_bE)},value:b_bz}));}b_bx({b_bF:'busy',b_bG:'busyInherited'},b_d);b_bx({b_bH:'enabled',b_bI:'enabledInherited'},b_c);return b_n;}});