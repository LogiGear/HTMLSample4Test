/*
	UIZE JAVASCRIPT FRAMEWORK

	http://www.uize.com/reference/Uize.Build.AutoScruncher.html
	Available under MIT License or GNU General Public License -- http://www.uize.com/license.html
*/
Uize.module({name:'Uize.Build.AutoScruncher',required:['Uize.Build.Wsh','Uize.Build.Util','Uize.Build.Scruncher','Uize.Date','Uize.String','Uize.String.Lines','Uize.Util.Oop'],builder:function(){'use strict';var _a=function(){};_a.perform=function(_b){var _c=Uize.Date.toIso8601(),_d=/\.js$/,_e=WScript.ScriptName,_f=_b.scrunchedHeadComments||{},_g='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ',_h,_i=_b.buildFolderPath,_j=_b.sourceFolderName,_k=Uize.Build.Wsh.getScriptFolderPath(),_l=_k+'\\'+_b.moduleFolderPath;function _m(_n){var _o=_j?_j.length:0;return(_o?(_n.slice(-_o)==_j?_n.slice(0,-_o-1):null):_i&&_k+'/'+_i+_n.substr(_k.length));}Uize.Build.Wsh.buildFiles(Uize.copyInto({logFilePath:_e.replace(_d,'-js-files.log'),targetFolderPathCreator:_m,targetFilenameCreator:function(_p){return _d.test(_p)?_p:null;},fileBuilder:function(_p,_q){var _r=_p.replace(_d,''),_s={},_t=_f[_p.slice(0,_p.indexOf('.'))],_u=_t==undefined;if(!_u)_s.KEEPHEADCOMMENT='FALSE';if(_h==_l)Uize.require(_r,function(_v){
var _w=Uize.Util.Oop.getInheritanceChain(_v).length;_s.MAPPINGS='='+(_w?_g.charAt(_w-1):'')+','+_r.replace(/\./g,'_');});var _x=Uize.Build.Scruncher.scrunch(_q,_s);return{outputText:(_u?'':Uize.substituteInto(_t,{buildDate:_c,moduleName:_r},'{KEY}'))+_x.scrunchedCode,logDetails:Uize.String.Lines.indent(_x.report,2)+'\n'};}},_b));var _y=/\/\*\s*Library\s*Contents/i,_z=/^[a-zA-Z_$]/,_A=_m(_l),_B='/*______________\n'+'|       ______  |   B U I L T     O N     U I Z E     F R A M E W O R K\n'+'|     /      /  |   ---------------------------------------------------\n'+'|    /    O /   |   This JavaScript application is developed using the object\n'+'|   /    / /    |   oriented UIZE JavaScript framework as its foundation.\n'+'|  /    / /  /| |\n'+'| /____/ /__/_| |    ONLINE : http://www.uize.com\n'+'|          /___ |   LICENSE : Available under MIT License or GNU General Public License\n'+'|_______________|             http://www.uize.com/license.html\n'+'*/\n\n';Uize.Build.Wsh.buildFiles(Uize.copyInto({
targetFolderPathCreator:_m,targetFilenameCreator:function(_p){return/\.library.js$/.test(_p)?_p:null;},fileBuilder:function(_p,_q){function _C(_D){var _E=_D.indexOf('/*');return(_E> -1?(_D.slice(0,_E)+_D.slice(_D.indexOf('*/',_E+2)+2)):_D);}var _F=[],_G;for(var _H= -1,_I=_q.search(_y),_J=_q.indexOf('*/',_I),_K=Uize.String.Lines.split(_I> -1?_q.slice(_I,_J).replace(_y,''):_q),_L=_K.length;++_H<_L;){var _r=Uize.String.trim(_K[_H]);if(_r&&_z.test(_r)){if(!_G)_G=Uize.String.startsWith(_r,'Uize');_F.push('\n'+_C(Uize.Build.Wsh.readFile(_A+'\\'+_r+(_d.test(_r)?'':'.js'))));}}return{outputText:(_G?_B:'')+_q.slice(0,_I)+_F.join('\n')+_q.slice(_J+2)};}},_b,{alwaysBuild:true,logFilePath:_e.replace(_d,'-libraries.log')}));};return _a;}});