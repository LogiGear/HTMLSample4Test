/*
	UIZE Web Site

	http://www.uize.com/reference/UizeSite.Build.FileBuilders.SotuPage.html
	Available under MIT License or GNU General Public License -- http://www.uize.com/license.html
*/
Uize.module({name:'UizeSite.Build.FileBuilders.SotuPage',required:['Uize.String','Uize.Build.Util'],builder:function(){function _a(_b){return((_b=='Uize'||Uize.String.startsWith(_b,'Uize.'))&& !Uize.String.startsWith(_b,'Uize.Test.'));}return{description:'SOTU (State of the UIZE) page',urlMatcher:function(_c){return _c.pathname==this.builtUrl('appendixes/sotu.html');},builderInputs:function(_c){var _d=this,_e=_d.params,_f={jstSource:_d.memoryUrlFromBuiltUrl(_c.pathname)+'.jst',referencesIndex:_d.memoryUrl('reference.index'),examplesByKeyword:_d.memoryUrl('examples-by-keyword')};Uize.forEach(Uize.Build.Util.getJsModules(_e),function(_b){if(_a(_b)){var _g=_d.getModuleUrl(_b);_f['moduleBuiltSize_'+_b]=_d.memoryUrl(_g+'.builtsize');_f['moduleMetaData_'+_b]=_d.memoryUrl(_g+'.metadata');}});return _f;},builder:function(_f){var _d=this,_h=_d.readFile({path:_f.referencesIndex}),_i=_d.readFile({path:_f.examplesByKeyword}),_j=[];for(var _k= -1,_l=_h.length;++_k<_l;){var _m=_h[_k],_b=_m.title;if(_a(_b)){var
 _n=_d.readFile({path:_f['moduleMetaData_'+_b]}),_o=0,_p=0;for(var _q=_k,_r=_b+'.',_s=_r.length;++_q<_l;){var _t=_h[_q].title;if(Uize.String.startsWith(_t,_r)){_p++;_t.indexOf('.',_s)== -1&&_o++;}}_j.push({name:_b,description:_m.description,examples:(_i[_b]||[]).length,directSubmodules:_o,nestedSubmodules:_p,type:_n.type||'Unknown',importance:+_n.importance||0,codeCompleteness:+_n.codeCompleteness||0,docCompleteness:+_n.docCompleteness||0,testCompleteness:+_n.testCompleteness||0,keywords:_n.keywords||'',scrunchedFileSize:_d.readFile({path:_f['moduleBuiltSize_'+_b]})});}}return _d.readFile({path:_f.jstSource})({modules:_j});}};}});