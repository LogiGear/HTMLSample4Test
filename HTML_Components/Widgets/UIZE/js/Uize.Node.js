/*
	UIZE JAVASCRIPT FRAMEWORK

	http://www.uize.com/reference/Uize.Node.html
	Available under MIT License or GNU General Public License -- http://www.uize.com/license.html
*/
Uize.module({name:'Uize.Node',required:'Uize.Class',builder:function(){'use strict';var _a=function(){},_b,_c='string',_d='object',_e='function',_f=true,_g=false,_h=null,_i='hidden',_j=Uize,_k=_j.copyInto,_l=_j.isPrimitive,_m=_j.returnFalse;var _n=typeof navigator!='undefined',_o=_n?navigator:{userAgent:'',appName:''},_p=_o.userAgent.toLowerCase(),_q=_o.appName=='Microsoft Internet Explorer',_r={TABLE:_f,THEAD:_f,TFOOT:_f,TBODY:_f,TR:_f,COL:_f,COLGRPUP:_f,FRAMESET:_f,HEAD:_f,HTML:_f,STYLE:_f,TITLE:_f},_s=_p.indexOf('applewebkit')> -1,_t=_p.indexOf('gecko')> -1,_u=_p.indexOf('opera')> -1,_v=_t||_u,_w= +(_q&&(_p.match(/MSIE\s*(\d+)/i)||[0,0])[1]),_x=_q&&_w<9,_y=_a._y={},_z={},_A=0,_B={clientX:0,clientY:0,pageX:0,pageY:0};var _C=_a._C=function(_D){_B.clientX=_D.clientX;_B.clientY=_D.clientY;_B.pageX=_D.pageX;_B.pageY=_D.pageY;};function _E(_F){var _G=document.getElementById(_F);return(!_q||(_G&&_G.id==_F))?_G:_h;}function _H(){return document[_s?'body':'documentElement'];}function _I(_J){return(
_a.VirtualEvent&&_J.charCodeAt(_J.length-1)==41?_a.VirtualEvent.resolve(_J):_J.charCodeAt(0)==111&&_J.charCodeAt(1)==110?_J.slice(2):_J);}var _K='table-',_L=_K+'row',_M=_K+'cell',_N=_k({SPAN:'inline',THEAD:_K+'header-group',TFOOT:_K+'footer-group',LI:'list-item'},_q&&typeof DOMImplementation=='undefined'?_h:{TABLE:'table',TR:_L,TH:_M,TD:_M,TBODY:_L+'-group',COLGROUP:_K+'column-group',COL:_K+'column',CAPTION:_K+'caption'});_a.display=function(_O,_P){_P=_P===_b|| !!_P;_Q(_O,function(_R){_R.style.display=_P?(_N[_R.tagName]||'block'):'none';});};var _Q=_a.doForAll=function(_O,_S,_T,_U){if(typeof _O==_c)_O=_V(_O,_T,_U);if(_O!=_b){if(_W(_O)){_S(_O);}else{var _X=typeof _O;if((_X==_d||_X==_e)&&typeof _O.length=='number'){for(var _Y= -1,_Z=_O.length;++_Y<_Z;)_Q(_O[_Y],_S,_T,_U);}else if(_X==_d){for(var _0 in _O)_Q(_O[_0],_S,_T,_U);}}}};var _1=_a.doRectanglesOverlap=function(_2,_3,_4,_5,_6,_7,_8,_9){return(_4-1+ +_2>=_6&&_8-1+ +_6>=_2&&_5-1+ +_3>=_7&&_9-1+ +_7>=_3);};var _V=_a.getById=function(_R,_T,_U){
if(typeof _R!=_c)return _R;var _G=_U?_U[_R]:_b;if(_G===_b){var _ba=_bb(_T,_R);(_G=_E(_ba))||(((_G=document.getElementsByName(_ba)).length<2)&&(_G=_G[0]||_h));if(_U)_U[_R]=_G;}return _G;};_a.find=function(_bc){if(typeof _bc!=_d|| !_bc||typeof _bc.length=='number'||_W(_bc))return _bc;var _bd=document,_be=[],_bf=_k({},_bc),_bg='root'in _bf?_V(_bf.root):_bd;delete _bf.root;if(_bg){var _bh=_bf.tagName;if('id'in _bf&&_l(_bf.id)){var _R=_E(_bf.id);_R&&_be.push(_R);delete _bf.id;}else if('name'in _bf&&_l(_bf.name)){_be=_bd.getElementsByName(_bf.name);delete _bf.name;}else{var _bi=_l(_bh);_bi&&delete _bf.tagName;_be=_bg.getElementsByTagName(_bh&&_bi?_bh:'*');_bg=_h;}if(_bg==_bd)_bg=_h;if(!_bh||_bh=='*')delete _bf.tagName;}var _bj=_be.length;for(var _bk in _bf)break;if(!_bj||(_bk==_b&& !_bg))return _be;var _bl=[],_bm;for(var _bn= -1;++_bn<_bj;){var _R=_be[_bn];if(_bm=_bg?_bo(_R,_bg):_f){for(var _bp in _bf){var _bq=_R[_bp],_br=_bf[_bp],_bs=_j.isFunction;if(!(_l(_br)?_bq==_br:(_br instanceof RegExp?_br.test(_bq||'')
:(_bs(_br)?_br.call(_R,_bq):_f)))){_bm=_g;break;}}}_bm&&_bl.push(_R);}return _bl;};var _bt=_a.getCoords=function(_R){var _bu=0,_bv=0,_bw=0,_bx=0,_by=_f,_bz=100,_bA=_H(),_bB=_bC(window);function _bD(){_bu+=_bA.scrollLeft;_bv+=_bA.scrollTop;}if(_R==window){_bD();_bw=_bB.width;_bx=_bB.height;}else if(_W(_R=_V(_R))){_bw=_R.offsetWidth;_bx=_R.offsetHeight;if(!(_bw&&_bx)&&_R.tagName=='DIV'){for(var _bE=_R.childNodes,_bF=_bE.length;--_bF>=0;){if(_bE[_bF].nodeName.charAt(0)!='#'){var _bG=_bt(_bE[_bF]);if(_bG.width||_bG.height){_bw=Math.max(_bw,_bG.right-_bu+1);_bx=Math.max(_bx,_bG.bottom-_bv+1);}}}}if(_R.tagName=='A'&&_R.childNodes.length==1&&_R.childNodes[0].tagName=='IMG')_R=_R.childNodes[0];var _bH=function(_R){return _bI(_R,'display')=='none'||_bI(_R,'visibility')==_i;},_bJ=_by= !_bH(_R),_bK=_R,_bL=_R,_bM=_bB.width,_bN=_bB.height,_bO=_bA.scrollLeft,_bP=_bA.scrollTop,_bQ=_bO+_bM,_bR=_bP+_bN;while(_bL.parentNode&&typeof _bL.parentNode!='unknown'){var _bS=_bL.offsetLeft||0,_bT=_bL.offsetTop||0,_bU=_bL.offsetWidth,
_bV=_bL.offsetHeight;if(_by&&_bH(_bL))_by=_g;if(_bL==_bK){_bu+=_bS+(parseInt(_bI(_bL,'borderLeftWidth'))||0);_bv+=_bT+(parseInt(_bI(_bL,'borderTopWidth'))||0);_bK=_bL.offsetParent;_bI(_bL,'position')=='fixed'&&_bD();}if(_bL!=_R&&_bL!=document.body&&_bL!=document.documentElement&&(_bL.scrollWidth>_bU||_bL.scrollHeight>_bV)){_bu-=_bL.scrollLeft;_bv-=_bL.scrollTop;if(_q){_bu+=_bL.clientLeft;_bv+=_bL.clientTop;}if(_by)_by=_1(_bu,_bv,_bw,_bx,_bS,_bT,_bU,_bV);}_bL=_bL.parentNode;}if(_by)_by=_1(_bu,_bv,_bw,_bx,_bO,_bP,_bM,_bN);_bz=_by?((Math.min(_bu+_bw,_bQ)-Math.min(Math.max(_bu,_bO),_bQ))*(Math.min(_bv+_bx,_bR)-Math.min(Math.max(_bv,_bP),_bR)))/(_bw*_bx)*100:0;}return{x:_bu,y:_bv,width:_bw,height:_bx,area:_bw*_bx,left:_bu,top:_bv,right:_bu+_bw-1,bottom:_bv+_bx-1,seen:_by,percentSeen:_bz};};var _bC=_a.getDimensions=function(_R){if(_R==window){var _bA=document.documentElement;return{width:_bA.clientWidth||window.innerWidth||_bA.offsetWidth,height:_bA.clientHeight||window.innerHeight||_bA.offsetHeight};
}else if(_R=_V(_R)){return{width:_R.offsetWidth||parseInt(_bI(_R,'width'))||0,height:_R.offsetHeight||parseInt(_bI(_R,'height'))||0};}else{return{width:0,height:0};}};var _bW={borderColor:['border','Color'],borderWidth:['border','Width'],padding:1,margin:1},_bI=_a.getStyle=function(_R,_bX){var _bY=typeof _bX==_c,_bZ=_bY?'':{};if(_R=_V(_R)){if(_bY){var _b0=_q&&_bX=='opacity',_b1=document.defaultView,_b2=_b1&&_b1.getComputedStyle(_R,'');if(_b0)_bX='filter';if(_b2){if(!(_bZ=_b2[_bX])){var _b3=_bW[_bX];if(_b3){var _b4=_b3[0]||_bX,_b5=_b3[1]||'',_b6=_b2[_b4+'Top'+_b5],_b7=_b2[_b4+'Right'+_b5],_b8=_b2[_b4+'Bottom'+_b5],_b9=_b2[_b4+'Left'+_b5];_bZ=_b6==_b7&&_b7==_b8&&_b8==_b9?_b9:_b6+' '+_b7+' '+_b8+' '+_b9;}}}else{var _ca=_R.currentStyle;_bZ=_ca?_ca.getAttribute(_bX):_R.style[_bX];}if(_b0){var _cb=(_bZ||'').match(/alpha\s*\(\s*opacity\s*=([^\)]*)\)/i);_bZ=_cb?_cb[1]/100:1;}}else{for(_bX in _bX)_bZ[_bX]=_bI(_R,_bX);}}return _bZ;};var _cc=_a.getText=function(_R){var _cd='';if(_R=_V(_R)){var _ce=function(_R){
if(typeof _R.innerText==_c){_cd+=_R.innerText.replace(/\r|\n|\r\n/g,'');}else if(typeof _R.textContent==_c){_cd+=_R.textContent;}else{if(_R.nodeType==3)_cd+=_R.data;_R.childNodes&&_j.forEach(_R.childNodes,_ce);}};_ce(_R);}return _cd;};_a.getValue=function(_R){var _bZ;if(_R=_V(_R)){if(_W(_R)){var _cf=_R.tagName;if(_cf=='TEXTAREA'){_bZ=_R.value;}else if(_cf=='INPUT'){_bZ=_R.type=='checkbox'?_R.checked:_R.value;}else if(_cf=='SELECT'){if(_R.multiple){_bZ=[];_j.forEach(_R.options,function(_cg){_cg.selected&&_bZ.push(_cg.value)});}else{_bZ=_R.value;}}else if(_cf=='IMG'){_bZ=_R.src;}else{_bZ=_R.innerHTML.replace(/<br\/?>/gi,'\n').replace(/&nbsp;/g,' ');}}else{_bZ=(_j.findRecord(_R,{tagName:'INPUT',type:'radio',checked:_f})||{}).value;}}return _bZ;};_a.injectHtml=function(_O,_ch,_ci){var _cj,_ck,_cl,_cm,_cn,_co,_cp=_j.isArray(_ch)||(_W(_ch)&&(_ch=[_ch]));((_cj=_ci=='inner replace')||(_ck=_ci=='outer replace')||(_cl=_ci=='inner top')||(_cm=_ci=='outer top')||(_cn=_ci=='outer bottom')||(_co=_f));_cp||(_ch+='');_Q(_O,
function(_R){var _cq=_R.childNodes;function _cr(_cs){return _cs&&/<script/i.test(_cs)}function _ct(){return _cr(_ch)}if((_cj||(!_cq.length&&(_cl||_co)))&& !_W&& !_ct()){_R.innerHTML=_ch;}else if(_ck&&_q&& !_W&& !_ct()){_R.outerHTML=_ch;}else{if(_cj)if(_q&&_r[_R.tagName]){var _cu=_R.cloneNode();_R.replaceNode(_cu);_R=_cu;}else _R.innerHTML='';if(_cp){var _cv=[];for(var _bn= -1,_cw=_ch.length;++_bn<_cw;)_cv.push(_ch[_bn].cloneNode(_f));}else{var _cx=document.createElement('DIV');_cx.innerHTML='<i>e</i>'+_ch;var _cv=_cx.childNodes}var _cy=_cl?_cq[0]:_cn?_R.nextSibling:_R,_cz=_R.parentNode,_cA= +!_cp,_cB=function(_R){if(_R.tagName=='SCRIPT'){var _cC=document.createElement('script');if(_R.id)_cC.id=_R.id;if(_R.type)_cC.type=_R.type;_cC.text=_R.text;if(_R.src)_cC.src=_R.src;_R.parentNode.replaceChild(_cC,_R);}else if(_cr(_R.innerHTML)){_j.forEach(_R.childNodes,_cB);}};while(_cv.length>_cA){var _cD=_cp?_cv.shift():_cv[_cA];if(_co||_cj){_R.appendChild(_cD);}else if(_cl){_cy?_R.insertBefore(_cD,_cy)
:_R.appendChild(_cD);}else if(_cm||_ck){_cz.insertBefore(_cD,_cy);}else if(_cn){_cy?_cz.insertBefore(_cD,_cy):_cz.appendChild(_cD);}_cp||_cB(_cD);}_ck&&_cz.removeChild(_R);}});};var _W=_a.isNode=function(_R){return!!(_R&&typeof _R==_d&&(_R.getAttribute||_R.documentElement||_R.self==_R));};var _bo=_a.isOnNodeTree=function(_R,_cE){_R=_V(_R);_cE=_V(_cE);while(_R){if(_R==_cE)return _f;_R=_R.parentNode;}return _g;};var _bb=_a.joinIdPrefixAndNodeId=function(_T,_F){return(_T||'')+(_T&&_F?'-':'')+_F;};_a.remove=function(_O){_Q(_O,function(_R){_R.parentNode.removeChild(_R)});};_a.setClipRect=function(_O,_b6,_b7,_b8,_b9){var _cF='rect('+_b6+'px, '+_b7+'px, '+_b8+'px, '+_b9+'px)';_Q(_O,function(_R){_R.style.clip=_cF});};var _cG=['left','top','width','height'];_a.setCoords=function(_O,_cH){_cI(_O,_j.isArray(_cH)?_j.meldKeysValues(_cG,_cH):_cH);};_a.centerInWindow=function(_O){var _cJ=_bt(window);_Q(_O,function(_R){var _cK=_bC(_R);_a.setCoords(_R,{left:_cJ.x+((_cJ.width-_cK.width)>>1),
top:_cJ.y+((_cJ.height-_cK.height)>>1)});});};_a.getEventAbsPos=function(_cL){var _cM=(_cL||(_cL=_B)).targetTouches;if(_cM&&_cM.length)_cL=_cM[0];if(_cL.pageX!=_b){return{left:_cL.pageX,top:_cL.pageY};}else{var _bA=_H();return{left:_cL.clientX+_bA.scrollLeft,top:_cL.clientY+_bA.scrollTop};}};var _cN=_a.setAbsPos=function(_O,_cO,_cP){_cP=typeof _cP=='number'?{x:_cP,y:_cP}:(_cP||{x:0,y:0});var _bA=document[_s?'body':'documentElement'],_cQ=_bC(window);_Q(_O,function(_R){function _cR(_cS,_cT,_cU,_cV){var _cW=_cO[_cS],_cX=_cP[_cV],_cY=_cW-_bA[_cT],_cZ=_cX+_cK[_cU];return(_cW+(_cY+_cZ>_cQ[_cU]?Math.max(-_cZ,-_cY):_cX));}var _cK=_bC(_R);_cI(_R,{left:_cR('left','scrollLeft','width','x'),top:_cR('top','scrollTop','height','y'),right:'auto',bottom:'auto'});});};_a.setAbsPosAdjacentTo=function(_O,_c0,_c1){_c0=_V(_c0);var _c2=_bt(_c0),_c3=_c2.width/2,_c4=_c2.height/2,_c5=_c1=='x'? -1:1;if(!_c3&& !_c4)_c2=_a.getEventAbsPos();_Q(_O,function(_R){_cN(_R,{left:_c2.left+_c3,top:_c2.top+_c4},{x:-_c3*_c5,y:_c4*_c5});});};
_a.setInnerHtml=function(_O,_cs){_cs+='';_Q(_O,function(_R){_R.innerHTML=_cs});};var _c6={};_a.setOpacity=function(_O,_c7){_c6.opacity=_c7;_cI(_O,_c6);};_a.setProperties=function(_O,_bc){_Q(_O,function(_R){_k(_R,_bc)});};var _cI=_a.setStyle=function(_O,_bc){_Q(_O,function(_R){var _c8=_R.style,_c9;if(_q&&'opacity'in _bc)_c8.filter=(_c9=Math.round(_bc.opacity*100))<100?'alpha(opacity='+_c9+')':'';for(var _bX in _bc)_c8[_bX]=(typeof(_c9=_bc[_bX])==_d&&_c9?(_c9=_c9.valueOf()):_c9)!=_b?(typeof _c9=='number'&&_bX!='opacity'&&_bX!='zIndex'?Math.round(_c9)+'px':_c9+''):'';});};_a.setValue=function(_O,_bZ){_bZ+='';_Q(_O,function(_R){var _cf=_R.tagName,_da=_R.readOnly;if(_da)_R.readOnly=_g;if(_cf=='TEXTAREA'){_R.value=_bZ;}else if(_cf=='INPUT'){var _db=_R.type;if(_db=='text'||_db==_i||_db=='password'){_R.value=_bZ;}else if(_db=='checkbox'){_R.checked=_bZ=='true';}else if(_db=='radio'){_R.checked=_R.value==_bZ;}}else if(_cf=='SELECT'){if(!_bZ){_R.selectedIndex= -1;}else{var _dc=_R.options;
if(_R.multiple&&(_bZ=='*'||_bZ.indexOf(',')> -1)){var _dd=_bZ!='*'?_j.lookup(_bZ.split(',')):_b;for(var _de=_dc.length,_cg;--_de>=0;)(_cg=_dc[_de]).selected= !_dd||_dd[_cg.value];}else{_R.selectedIndex=_j.findRecordNo(_dc,{value:_bZ},_R.selectedIndex);}}}else if(_cf=='IMG'){if(_bZ)_R.src=_bZ;}else{_cf=='PRE'&&_q?(_R.innerText=_bZ):(_R.innerHTML=_bZ.replace(/</g,'&lt;').replace(/\n/g,'<br/>'));}if(_da)_R.readOnly=_da;});};_a.show=function(_O,_df){_cI(_O,{visibility:_df||_df===_b?'inherit':_i});};_a.showClickable=function(_O,_dg){_cI(_O,{cursor:_dg||_dg===_b?(_x?'hand':'pointer'):'default'});};var _dh=_a.unwire=function(_O,_di,_dj,_dk){if(typeof _di==_d&&_di&& !_di.virtualDomEvent){for(var _J in _di)_dh(_O,_J,_di[_J],_dj);}else{_a.unwireEventsByOwnerId(_dk,_O!==_b||_di!=_b||_dj!=_b?{node:_O,eventName:_di,handler:_dj}:_b);}};_a.unwireEventsByOwnerId=function(_dl,_dm){var _dn=_z[_dl=_dl||''];if(_dn){var _do=function(_dp){if(_dp!==_h){var _dq=_dm&&_dm.eventName,_dr=_dm&&_dm.handler,_ds=_dp||_dq||_dr;
if(_dq&&_dq.charCodeAt)_dq=_I(_dq);for(var _dt=_dn.length;--_dt>=0;){var _du=_dn[_dt],_dv=_y[_du],_R=_dv._R,_J=_dv._J;if(!_ds||((!_dp||_dp==(_dv._dw||_R))&&(!_dq||_dq==_J)&&(!_dr||_dr==_dv._dx))){_ds&&_dn.splice(_dt,1);if(_dv._dy){_a.unwireEventsByOwnerId(_dv._dy)}else{try{_R==window?_dz.unwire(_J,_dv._dA):_q?_R.detachEvent('on'+_J,_dv._dA):_R.removeEventListener(_J,_dv._dA,_g);}catch(_dB){}}delete _y[_du];}}(_ds&&_dn.length)||delete _z[_dl];}};_dm&&_dm.node!==_b?_Q(_dm.node,_do):_do();}};var _dC=Uize.quarantine,_dD=_dC(function(_du){return(function(_D){var _dv=window.Uize&&Uize.Node._y[_du];return _dv&&_dv._dx.call(_dv._R,_D.windowEvent);});}),_dE=_dC(function(_du){return(function(_D){var _dv=window.Uize&&Uize.Node._y[_du];return _dv&&_dv._dx.call(_dv._R,_D||window.event);});}),_dF={click:_dE,mouseover:_dC(function(_du){return(function(_D){var _dv=window.Uize&&Uize.Node._y[_du],_dG=(_D||(_D=window.event)).fromElement||_D.relatedTarget;if(_dv){if(_dG){try{
if(!_dG.Uize_Widget_Drag_shield&& !Uize.Node.isOnNodeTree(_dG,_dv._R))_dG=null;}catch(_dB){_dG=null;}}if(!_dG){Uize.Node._C(_D);return _dv._dx.call(_dv._R,_D);}}});}),mouseout:_dC(function(_du){return(function(_D){var _dv=window.Uize&&Uize.Node._y[_du],_dH=(_D||(_D=window.event)).toElement||_D.relatedTarget;if(_dv){if(_dH){try{if(!_dH.Uize_Widget_Drag_shield&& !Uize.Node.isOnNodeTree(_dH,_dv._R))_dH=null;}catch(_dB){_dH=null;}}if(!_dH)return _dv._dx.call(_dv._R,_D);}});}),mousedown:_dE,mouseup:_dE};_a.wire=function(_O,_J,_dx,_dl){if(!_J)return;if(_dl==_b)_dl='';var _dI;if(_J.charCodeAt)_J=_I(_J);if(typeof _J==_d&& !(_dI= !!_J.virtualDomEvent)){_dl=arguments[2]||'';for(var _D in _J)_a.wire(_O,_D,_J[_D],_dl);return;}_Q(_O,function(_R){var _cf=_R.tagName;(_z[_dl]||(_z[_dl]=[])).push(_A);var _dA=(_dI?_m:_R==window?_dD:_dF[_J]||_dE)(_A);var _dv=_y[_A++]={_R:_R,_J:_J,_dx:_dx,_dA:_dA};if(_v&&_cf=='BODY'&&_J=='scroll'){_dv._dw=_R;_R=_dv._R=document;}if(_dA){var _dJ='on'+_J;_R==window?_dz.wire(_J,_dA):_q
?_R.attachEvent(_dJ,_dA):_R.addEventListener(_J,_dA,_g);if(_cf=='A'&&(_J=='mousedown'||_J=='click')&& !_R[_dJ])_R[_dJ]=_m;}else if(_dI){_J.wire(_R,_dx,_dv._dy=_j.getGuid());}});};_a.ieMajorVersion=_w;_a.isIe=_q;_a.isSafari=_s;_a.isMozilla=_t;if(_n){_a.wire(document.documentElement,'mousemove',_C);var _dz=Uize.Class(),_dK=setTimeout(function(){_dz.fire('load')},15000);_j.forEach(['focus','blur','load','beforeunload','unload','resize','scroll'],function(_dL){var _dM='on'+_dL,_dN=window[_dM]||_m;window[_dM]=function(_D){_dL=='load'&&clearTimeout(_dK);_dN.call(window,_D||(_D=window.event));_dz.fire({name:_dL,windowEvent:_D});};});}_a.returnFalse=_m;_a.returnTrue=_j.returnTrue;return _a;}});