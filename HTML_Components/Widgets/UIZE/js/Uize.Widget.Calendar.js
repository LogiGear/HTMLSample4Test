/*
	UIZE JAVASCRIPT FRAMEWORK

	http://www.uize.com/reference/Uize.Widget.Calendar.html
	Available under MIT License or GNU General Public License -- http://www.uize.com/license.html
*/
Uize.module({name:'Uize.Widget.Calendar',superclass:'Uize.Widget.V2',required:['Uize.Widget.Button','Uize.Date','Uize.Date.Formatter'],builder:function(d_a){'use strict';var d_b=true,d_c=false,d_d=null,d_e=Uize.Date,d_f=d_e.dayNames,d_g=d_e.monthNames,d_h=Uize.Date.Formatter.format;function d_i(d_j){return d_e.Formatter.parse(d_j,this.d_k)||null;}function d_l(d_m,d_n,d_o){var d_p=d_m.addChild(d_n,d_m.Class.buttonWidgetClass);d_p.wire('Click',d_o);return d_p;}function d_q(){var d_m=this,d_r={minValue:d_m.d_s,maxValue:d_m.d_t};d_m.d_j&& !d_e.inRange(d_m.d_j,d_r)&&d_m.set({d_j:d_d});var d_u=d_m.d_j||new Date;if(!d_e.inRange(d_u,d_r))d_u=d_m.d_s||d_m.d_t;d_m.set({d_v:d_u.getMonth(),d_w:d_u.getFullYear()});}function d_x(){var d_m=this;if(d_m.d_y){var d_z=new Date(d_m.d_w,d_m.d_v,1),d_A=d_e.getRangeAround(d_z,'month'),d_B=d_e.getRangeAround(d_z,'year'),d_s=d_m.d_s,d_t=d_m.d_t,d_C=function(d_D,d_E){d_D.set({enabled:d_E?'inherit':d_c});};d_C(d_m.d_F,!d_s||d_s<d_A.minValue);d_C(d_m.d_G,!d_t||d_t>d_A.maxValue);
d_C(d_m.d_H,!d_s||d_s<d_B.minValue);d_C(d_m.d_I,!d_t||d_t>d_B.maxValue);}}function d_J(){this.isWired&&this.setNodeValue('month',d_g[this.d_v]);}function d_K(){this.isWired&&this.setNodeValue('year',this.d_w);}function d_L(){var d_m=this;if(d_m.isWired){var d_M=function(d_u,d_N){return(d_u?d_u.getFullYear()*10000+(d_u.getMonth()+1)*100+d_u.getDate():d_N);},d_j=d_m.d_j,d_s=d_m.d_s,d_t=d_m.d_t,d_w=d_m.d_w,d_v=d_m.d_v,d_O=d_e.getDaysInMonth(d_v,d_w),d_P=new Date(d_w,d_v,1),d_Q=d_M(d_P),d_R=Uize.constrain(d_M(d_s,0)-d_Q+1,1,d_O+1),d_S=Uize.constrain(d_M(d_t,Infinity)-d_Q+1,-1,d_O),d_T=d_m.d_T;if(!d_T||d_j!=d_T.d_j||d_v!=d_T.d_v||d_w!=d_T.d_w||d_R!=d_T.d_R||d_S!=d_T.d_S){var d_U=d_m.Class.useV2CssClasses,d_V=d_U?d_m.cssClass('selected'):'selected',d_W=d_U?d_m.cssClass('grayed'):'grayed';if(d_T){for(var d_X=0,d_Y;++d_X<32;){d_m.unwireNode(d_Y='day'+d_X);d_m.flushNodeCache(d_Y);}}if(!d_T)d_T=d_m.d_T={};d_T.d_j=d_j;d_T.d_v=d_v;d_T.d_w=d_w;d_T.d_R=d_R;d_T.d_S=d_S;
var d_Z=['<table'+(d_U?'':' class="calendarGrid"')+' cellpadding="0" cellspacing="0"><tr>'];var d_0=d_m.d_0;for(var d_X= -1;++d_X<7;)d_Z.push('<th title="'+d_f[d_X]+'">'+d_f[d_X].slice(0,d_0)+'</th>');d_Z.push('</tr><tr>');var d_1=d_M(d_j,d_d),d_2=d_m.get('idPrefix'),d_X=1-d_P.getDay();for(var d_3= -1;++d_3<6;){d_Z.push('<tr>');for(var d_4= -1;++d_4<7;){var d_5=new Date(d_w,d_v,d_X);if(d_X>0&&d_X<=d_O){var d_6=d_M(new Date(d_w,d_v,d_X))==d_1,d_7=d_h(d_5,'{dayName}, {dayNo}{dayNoSuffix} of {monthName}, {YYYY}');d_Z.push(d_X>=d_R&&d_X<=d_S?('<td'+(d_6?' class="'+d_V+'"':'')+' title="'+d_7+'"><a href="javascript://" id="'+d_2+'-day'+d_X+'">'+d_X+'</a></td>'):('<td class="'+(d_6?d_V+' ':'')+d_W+'" title="'+d_7+'">'+d_X+'</td>'),'</td>');}else{d_Z.push('<td>&nbsp;</td>');}d_X++;}d_Z.push('</tr>');}d_Z.push('</table>');d_m.setNodeInnerHtml('grid',d_Z.join(''));for(var d_X=d_O+1,d_8=function(d_X){d_m.wireNode('day'+d_X,'click',function(){d_m.set({d_j:new Date(d_w,d_v,d_X)})});};--d_X>0;)d_8(d_X);}}else{d_m.d_T=d_d;}
}return d_a.subclass({omegastructor:function(){var d_m=this;d_m.d_G=d_l(d_m,'nextMonth',function(){d_m.set({d_v:d_m.d_v+1})});d_m.d_F=d_l(d_m,'previousMonth',function(){d_m.set({d_v:d_m.d_v-1})});d_m.d_I=d_l(d_m,'nextYear',function(){d_m.set({d_w:d_m.d_w+1})});d_m.d_H=d_l(d_m,'previousYear',function(){d_m.set({d_w:d_m.d_w-1})});d_m.d_y=d_b;d_x.call(d_m);},instanceMethods:{updateUi:function(){d_J.call(this);d_K.call(this);d_L.call(this);}},stateProperties:{d_0:{name:'dayNameLength',value:1},d_k:'displayFormat',d_t:{name:'maxValue',conformer:d_i,onChange:[d_q,d_L,d_x]},d_s:{name:'minValue',conformer:d_i,onChange:[d_q,d_L,d_x]},d_v:{name:'month',conformer:function(d_j){var d_9=Math.floor(d_j/12);d_9&&this.set({d_w:this.d_w+d_9});return((d_j%12)+12)%12;},onChange:[d_J,d_L,d_x]},d_ba:{name:'snapViewOnValueChange',value:d_b},d_j:{name:'value',conformer:d_i,value:new Date,onChange:[function(){this.d_ba&&d_q.call(this)},d_L,d_x]},d_w:{name:'year',onChange:[d_K,d_L,d_x]}},staticProperties:{
buttonWidgetClass:Uize.Widget.Button,useV2CssClasses:false}});}});